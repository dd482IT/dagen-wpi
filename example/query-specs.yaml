defaultSchema: drugs
generateUnqualifiedNamesForSchemas: ["drugs"]
querySpecs:
  - queryName: drugs query
    resultsRepresentations: # (defaults to ["JSON_OBJECT_ROWS"] if not present)
      - JSON_OBJECT_ROWS
#      - JSON_ARRAY_ROW
#      - MULTI_COLUMN_ROWS
    generateResultTypes: true
    tableOutputSpec:
      tableName: drug
      nativeFields:
        - databaseFieldName: name
        - databaseFieldName: mesh_id
        - databaseFieldName: cid
          fieldTypeOverrides:
            - language: Java
              typeDeclaration: Optional<Integer>
        - databaseFieldName: therapeutic_indications
        - fieldExpression: "$a : $a.cid + 1000"
          outputName: cidPlus1000
          fieldTypeOverrides:
            - language: Java
              typeDeclaration: Optional<Integer>
      childCollections:
        - childCollectionName: references
          childTableOutputSpec:
            tableName: drug_reference
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: reference
                  nativeFields:
                    - databaseFieldName: publication
        - childCollectionName: brands
          childTableOutputSpec:
            tableName: brand
            nativeFields:
              - databaseFieldName: brand_name
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: manufacturer
                  nativeFields:
                    - databaseFieldName: name
                      outputName: manufacturer
        - childCollectionName: advisories
          childTableOutputSpec:
            tableName: advisory
            nativeFields:
              - databaseFieldName: text
                outputName: advisoryText
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: advisory_type
                  nativeFields:
                    - databaseFieldName: name
                      outputName: advisoryType
                  inlineParents:
                    - inlineParentTableOutputSpec:
                        tableName: authority
                        nativeFields:
                          - databaseFieldName: name
                            outputName: authorityName
                          - databaseFieldName: url
                            outputName: authorityUrl
                          - databaseFieldName: description
                            outputName: authorityDescription
        - childCollectionName: functionalCategories
          childTableOutputSpec:
            tableName: drug_functional_category
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: functional_category
                  nativeFields:
                    - databaseFieldName: name
                      outputName: categoryName
                    - databaseFieldName: description
              - inlineParentTableOutputSpec:
                  tableName: authority
                  nativeFields:
                    - databaseFieldName: name
                      outputName: authorityName
                    - databaseFieldName: url
                      outputName: authorityUrl
                    - databaseFieldName: description
                      outputName: authorityDescription
      referencedParents:
        - referenceFieldName: analyst
          referencedParentTableOutputSpec:
            tableName: analyst
            nativeFields:
              - databaseFieldName: id
              - databaseFieldName: short_name
        - referenceFieldName: compound
          childForeignKeyFields:
            - compound_id
          referencedParentTableOutputSpec:
            tableName: compound
            nativeFields:
              - databaseFieldName: display_name
              - databaseFieldName: nctr_isis_id
              - databaseFieldName: cas
            referencedParents:
              - referenceFieldName: analyst
                referencedParentTableOutputSpec:
                  tableName: analyst
                  nativeFields:
                    - databaseFieldName: id
                    - databaseFieldName: short_name
      filter: '$d : not $d.id = 2' # "<alias-var> : <expr using alias-var>", both sides trimmed
