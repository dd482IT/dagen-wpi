defaultSchema: public
generateUnqualifiedNamesForSchemas:
  - public
querySpecs:
  - queryName: drugs query
    resultsRepresentations:
      - JSON_OBJECT_ROWS
      - MULTI_COLUMN_ROWS
      - JSON_ARRAY_ROW
    generateResultTypes: yes
    tableOutputSpec:
      tableName: drug
      nativeFields:
        - databaseFieldName: name
        - databaseFieldName: mesh_id
        - databaseFieldName: cid
        - databaseFieldName: therapeutic_indications
      childCollections:
        - childCollectionName: references
          childTableOutputSpec:
            tableName: drug_reference
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: reference
                  nativeFields:
                    - databaseFieldName: publication
        - childCollectionName: brands
          childTableOutputSpec:
            tableName: brand
            nativeFields:
              - databaseFieldName: brand_name
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: manufacturer
                  nativeFields:
                    - databaseFieldName: name
                      outputName: manufacturer
        - childCollectionName: advisories
          childTableOutputSpec:
            tableName: advisory
            nativeFields:
              - databaseFieldName: text
                outputName: advisoryText
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: advisory_type
                  nativeFields:
                    - databaseFieldName: name
                      outputName: advisoryType
                  inlineParents:
                    - inlineParentTableOutputSpec:
                        tableName: authority
                        nativeFields:
                          - databaseFieldName: name
                            outputName: authorityName
                          - databaseFieldName: url
                            outputName: authorityUrl
                          - databaseFieldName: description
                            outputName: authorityDescription
        - childCollectionName: functionalCategories
          childTableOutputSpec:
            tableName: drug_functional_category
            inlineParents:
              - inlineParentTableOutputSpec:
                  tableName: functional_category
                  nativeFields:
                    - databaseFieldName: name
                      outputName: categoryName
                    - databaseFieldName: description
              - inlineParentTableOutputSpec:
                  tableName: authority
                  nativeFields:
                    - databaseFieldName: name
                      outputName: authorityName
                    - databaseFieldName: url
                      outputName: authorityUrl
                    - databaseFieldName: description
                      outputName: authorityDescription
      referencedParents:
        - referenceFieldName: compound
          childForeignKeyFields:
            - compound_id
          referencedParentTableOutputSpec:
            tableName: compound
            nativeFields:
              - databaseFieldName: display_name
              - databaseFieldName: nctr_isis_id
              - databaseFieldName: cas
      filter: '$d : not $d.id = 2' # "<alias-var> : <expr using alias-var>", both sides trimmed
